---
title: 函数积分七：矩形区域的二重积分
date: 2021-06-21 20:23:38
tags:
    - 数学分析
    - 函数积分
    - 二重积分
categories: 数学
mathjax: true
---

#### 定义1
> 定义$f: I \to \mathbb{R}$， 其中$I$是$\mathbb{R}^2$中的闭矩形，$I = [a,b] \times [c, d]$，作$[a,b]$的分割
$$
    \pi_x : a = x_0 < x_1 < \cdots < x_n = b;
$$
又作$[c,d]$的分割
$$
    \pi_y : c = y_0 < y_1 < \cdots < y_n = d;
$$
两族平行直线$x = x_i(i=0,1,\cdots,n)$与$y=y_j(j=0,1,\cdots,m)$把$I$分割成$k= n \times m$个子矩形：
$$
    [x_{i-1}, x_i] \times [y_{j-1}, y_j] \quad (i=1,2,\cdots,n; j=1,2,\cdots,m)
$$
这$k$个子矩形的全体组成$I$的一个分割$\pi = \pi_x \times \pi_y$，用一定次序重排这$k$个子矩形，将它们编号为$I_1,I_2,\cdots, I_k$，在每一个$I_i$中任取一点$\xi_i (i=1,2,\cdots,k)$，作积分和
$$
    \sum_{i=1}^k f(\xi_i) \sigma(I_i) \tag{1}
$$
其中$\sigma(I_i)$表示$I_i$区域的面积。记
$$
    \Vert \pi \Vert = \max(\mathrm{diam}(I_1), \mathrm{diam}(I_2), \cdots, \mathrm{diam}(I_k))
$$
这里$\mathrm{diam}(I_i)$表示矩形$I_i$的对角线的长度，称$\Vert \pi \Vert$为分割$\pi$的宽度。令$\boldsymbol{\xi} = (\boldsymbol{\xi_1}, \boldsymbol{\xi_2}, \cdots, \boldsymbol{\xi_k})$，称$\boldsymbol{\xi}$为积分和$(1)$的值点向量，称$\boldsymbol{\xi_1}, \boldsymbol{\xi_2},\cdots, \boldsymbol{\xi_k}$为值点。

<!--more-->

#### 定义2
> 如果存在数$A$，使得对任意的给定的$\varepsilon > 0$，存在$\delta > 0$，当$\Vert \pi \Vert < \delta$时，不论值点$\xi_i$在子矩形$I_i$中如何选择，都有
$$
    \left| \sum_{i=1}^k f(\boldsymbol{\xi_i}) \sigma(I_i) - A \right| < \varepsilon
$$
则称函数$f$在矩形$I$上可积，并将$A$写作
$$
    \iint \limits_I f(x,y) \mathrm{d}x \mathrm{d}y \quad 或 \quad \int_I f \mathrm{d} \sigma
$$
称之为$f$在矩形$I$上的二重积分，也可简称为$f$在$I$上的积分，这里$f$称为被积函数，$I$称为积分区域。上述定义用极限过程记为
$$
    \lim \limits_{\Vert \pi \Vert \to 0} \sum_{i=1}^k f(\boldsymbol{\xi_i}) \sigma(I_i) = A
$$

#### 定理1
> 如果$f$在$I$上可积，那么$f$必在$I$上有界。

证：与[函数积分三的定理1](https://gamersover.github.io/2021/05/14/函数积分3#定理1)证明方法一样。

Q.E.D.


#### 定理2
> 设$f$和$g$在$I$上可积，那么 <br/>
（1）若$c$为任何常数，那么$cf$在$I$上也可积，并且
$$
    \int_I (cf) \mathrm{d} \sigma = c \int_I f \mathrm{d} \sigma
$$
（2）$f \pm g$在$I$上可积，并且
$$
    \int_I (f \pm g) \mathrm{d} \sigma = \int_I f \mathrm{d} \sigma \pm \int_I g \mathrm{d} \sigma
$$
（3）若$f \ge 0$，则
$$
    \int_I f \mathrm{d} \sigma \ge 0
$$
（4）若$f \ge g$，则
$$
    \int_I f \mathrm{d} \sigma \ge \int_I g \mathrm{d} \sigma
$$

证：由积分的定义易推出（1）（2）（3）；由（2）（3）易推出（4）。

Q.E.D.

#### 定义3
> 设$f$定义在$I$上，有分割
$$
    \pi: I_1, I_2, \cdots, I_k
$$
则
$$
    S(f, \pi) = \sum_{i=1}^k f(\boldsymbol{\xi_i}) \sigma(I_i)
$$
称为$f$关于分割$\pi$的Riemann和。令
$$
    m_i = \inf f(I_i), \quad M_i = \sup f(I_i) \quad (i=1,2,\cdots,k)
$$
定义
$$
    \underline S(f, \pi) = \sum_{i=1}^k m_i \sigma(I_i), \quad \overline S(f, \pi) = \sum_{i=1}^k M_i \sigma(I_i)
$$
分别称为$f$关于分割$\pi$的下和与上和。


#### 定义4
> 设分割$\pi = \pi_x \times \pi_y$与$\pi^\prime = \pi_x^\prime \times \pi_y^\prime$是$I$的两个分割，如果$\pi_x \le \pi_x^\prime$且$\pi_y \le \pi^\prime$，那么称分割$\pi$比$\pi^\prime$粗，或者称分割$\pi^\prime$比$\pi$细，记$\pi \le \pi^\prime$。

#### 定理3
> 设$\pi$和$\pi^\prime$是矩形$I$的两个分割，并且$\pi \le \pi^\prime$，那么
$$
    \underline S(f, \pi) \le \underline S(f, \pi^\prime) \le \overline S(f, \pi^\prime) \le \overline S(f, \pi)
$$

证：与[函数积分三的定理2](https://gamersover.github.io/2021/05/14/函数积分3#定理2)证明方法类似。


#### 定理4
> 设$\pi_1$和$\pi_2$是$I$的任何两个分割，那么
$$
    \underline S(f, \pi) \le \overline S(f, \pi)
$$

证：与[函数积分三的定理3](https://gamersover.github.io/2021/05/14/函数积分3#定理3)证明方法类似。


#### 定义5
> 所有下和构成的集合有上界，从而有上确界，令
$$
    \underline {\int}_I f \mathrm{d} \sigma = \sup \limits_\pi \underline S(f, \pi)
$$
称这个数为$f$在$I$上的下积分；而所有上和构成的集合有下界，从而有下确界，令
$$
    \overline {\int}_I f \mathrm{d} \sigma = \inf \limits_\pi \overline S(f, \pi)
$$
称这个数为$f$在$I$上的上积分。

#### 定理6
> 等式
$$
    \underline {\int}_I f \mathrm{d} \sigma = \overline {\int}_I \mathrm{d} \sigma
$$
成立的充分必要条件是，对任意给定的$\varepsilon > 0$，存在$I$的一个分割$\pi$，使得
$$
    \overline S(f, \pi) - \underline S(f, \pi) < \varepsilon
$$

证：必要性。设
$$
    A = \underline {\int}_I f \mathrm{d} \sigma = \overline {\int} \mathrm{d} \sigma
$$
由下积分的定义可知，对任意给定的$\varepsilon > 0$，存在矩形$I$的一个分割$\pi_1$，使得
$$
    \underline S(f, \pi_1) > A - \frac{\varepsilon}{2}
$$
又由上积分的定义可知，存在矩形$I$的一个分割$\pi_2$，使得
$$
    \overline S(f, \pi_2) < A + \frac{\varepsilon}{2}
$$
把分割$\pi_1$与$\pi_2$合在一起得到分割$\pi$，从而有
$$
    A - \frac{\varepsilon}{2} < \underline S(f, \pi_1) \le \underline S(f, \pi) \le \overline S(f, \pi) \le \overline S(f, \pi_2) < A + \frac{\varepsilon}{2}
$$
从而有
$$
    \overline S (f, \pi) - \underline S(f, \pi) < A + \frac{\varepsilon}{2} - (A - \frac{\varepsilon}{2}) = \varepsilon
$$
充分性。有
$$
    0 \le \overline \int_I f \mathrm{d} \sigma - \underline \int_I f \mathrm{d} \sigma \le \overline S(f, \pi) - \underline S(f, \pi) < \varepsilon
$$
由于$\varepsilon$是任意的正数，从而必有
$$
    \underline \int_I f \mathrm{d} \sigma = \overline \int_I f \mathrm{d} \sigma
$$

Q.E.D.

#### 定理7
> 有界函数$f$在矩形$I$上可积的充分必要条件是
$$
    \underline \int_I f \mathrm{d} \sigma = \overline \int_I f \mathrm{d} \sigma
$$
这个公共的值就是积分值$\displaystyle \int_I f \mathrm{d} \sigma$。

证：必要性。设$f$在$I$上的积分值为$A$，从而对任意的$\varepsilon > 0$，必存在$I$的一个分割$\pi = \{I_1, I_2, \cdots, I_k \}$，对任意的值点$\boldsymbol{\xi_i} \in I_i (i=1,2,\cdots,k) $，有不等式
$$
    A - \varepsilon < \sum_{i=1}^k f(\boldsymbol{\xi_i}) \sigma(I_i) < A + \varepsilon
$$
由于$\boldsymbol{\xi_i}$是任取的，所以有
$$
    A - \varepsilon \le \underline S(f, \pi) \le \overline S(f, \pi) \le A + \varepsilon
$$
从而
$$
    A - \varepsilon \le \underline \int_I f \mathrm{d} \sigma \le \overline \int_I f \mathrm{d} \sigma \le A + \varepsilon
$$
令$\varepsilon \to 0$，可得
$$
    \underline \int_I f \mathrm{d} \sigma = \overline \int_I f \mathrm{d} \sigma = A
$$
充分性。假设
$$
    \underline \int_I f \mathrm{d} \sigma = \overline \int_I f \mathrm{d} \sigma = A
$$
成立。要证对任意$\varepsilon > 0$，存在$\delta > 0$，只要$I$的分割$\pi = \{ I_1, I_2, \cdots, I_k \}$满足$\Vert \pi \Vert < \delta$，有
$$
    |S(f, \pi) - A| < \varepsilon
$$
首先有
$$
    \underline S(f, \pi) \le S(f, \pi) \le \overline S(f, \pi)
$$
而
$$
    \underline S(f, \pi) \le A \le \overline S(f, \pi)
$$
所以
$$
    |S(f, \pi) - A| \le \overline S(f, \pi) - \underline S(f, \pi) = \sum_{j=1}^k f(M_j - m_j) \sigma(I_j) \tag{2}
$$
由于$f$在$I$上有界，不妨设$|f(\boldsymbol{p})| \le M (\boldsymbol{p} \in I)$；而由[定理6](https://gamersover.github.io/2021/06/21/函数积分7/#定理6)可知，存在$I$的分割$\pi_\varepsilon = \{J_1, J_2, \cdots, J_t\}$，使得
$$
    \overline S(f, \pi_\varepsilon) - \underline S(f, \pi_\varepsilon) < \frac{\varepsilon}{2}
$$
将子矩形$J_i$的每一边平行的向矩形内部收缩同一距离$\delta>0$，得到一个开矩形$\tilde{J_i} \subset J_i (i=1,2,\cdots, t)$，令
$$
    K = I \cap \left( \bigcup \limits_{i=1}^t \tilde {J_i} \right)^c
$$
显然$K$是一个闭集，取$\delta$充分小，使得
$$
    \sigma(K) < \frac{\varepsilon}{4M}
$$
这时将$(2)$式写为
$$
     |S(f, \pi) - A| \le  \sum_{j=1}^k f(M_j - m_j) \sigma(I_j) = \sum \nolimits_1 + \sum \nolimits_2
$$
其中
$$
    \begin{aligned}
    \sum \nolimits_1 = \sum_{I_j \subset K} (M_j - m_j) \sigma(I_j) \\
    \sum \nolimits_2 = \sum_{I_j \nsubseteq K} (M_j - m_j) \sigma(I_j)
    \end{aligned}
$$
一方面
$$
    \sum \nolimits_1 \le 2M \sum_{I_j \subset K} \sigma(I_j) < 2M \cdot \frac{\varepsilon}{4M} = \frac{\varepsilon}{2}
$$
另一方面，$\sum \nolimits_2$中的$I_j \nsubseteq K$，从而$I_j$必与某个$\tilde {J_i}$相交，而$\Vert \pi \Vert < \delta$，所以$I_j \subset J_i$，所以
$$
    \begin{aligned}
    \sum \nolimits_2 &= \sum_{i=1}^t \sum_{I_j \subset J_i} (M_j - m_j) \sigma(I_j) \\
    & \le \sum_{i=1}^t (\sup f(J_i) - \inf f(J_i)) \sum_{I_j \subset J_i} \sigma(I_j) \\
    & \le \sum_{i=1}^t (\sup f(J_i) - \inf f(J_i)) \sigma(J_i) \\
    & = \overline S(f, \pi) - \underline S(f, \pi) < \frac{\varepsilon}{2}
    \end{aligned}
$$
从而
$$
    \sum \nolimits_1 + \sum \nolimits_2 < \frac{\varepsilon}{2} + \frac{\varepsilon}{2} = \varepsilon
$$
即
$$
    |S(f, \pi) - A| < \varepsilon
$$

Q.E.D.


#### 定理8
> 设$f$在$I = [a, b] \times [c, d]$上有界，那么以下条件等价： <br/>
（1）$f$在$I$上可积； <br/>
（2）$\displaystyle \lim_{\Vert \pi \Vert \to 0} \sum_{i=1}^k \omega_i \sigma(I_i) = 0$，其中$\omega_i = M_i - m_i (i=1,2,\cdots,k)$； <br/>
（3）对任意的$\varepsilon > 0$，存在$I$的一个分割$\pi$，使得
$$
    \overline S(f, \pi) - \underline S(f, \pi) < \varepsilon
$$
（4）$\displaystyle \underline \int_I f \mathrm{d} \sigma = \overline \int_I f \mathrm{d} \sigma$。

证：$(2) \Rightarrow (3)$显然；$(3) \Rightarrow (4)$由[定理6](https://gamersover.github.io/2021/06/21/函数积分7/#定理6)可知；$(4) \Rightarrow (1)$由[定理7](https://gamersover.github.io/2021/06/21/函数积分7/#定理7)可知；下面证$（1）\Rightarrow （2）$。假设$f$在$I$上的积分值为$A$，由可积的定义知，对任意的$\varepsilon > 0$，存在$\delta > 0$，使得对于分割$\pi = \{ I_1, I_2, \cdots, I_k \}$满足$\Vert \pi \Vert < \delta$，则对任意的值点$\boldsymbol{\xi_i}$有
$$
    A - \frac{\varepsilon}{2} < \sum_{i=1}^k f(\xi_i) < A + \frac{\varepsilon}{2}
$$
由于$\boldsymbol{\xi_i}$是任取的，所以
$$
    A - \frac{\varepsilon}{2} \le \underline S(f, \pi) \le \overline S(f, \pi) \le A + \frac{\varepsilon}{2}
$$
即
$$
    \overline S(f, \pi) - \underline S(f, \pi) = \sum_{i=1}^k \omega_i \sigma(I_i) < \varepsilon
$$
所以
$$ 
    \lim_{\Vert \pi \Vert \to 0} \sum_{i=1}^k \omega_i\sigma(I_i) = 0
$$

Q.E.D.