---
title: 函数积分三：可积性理论
date: 2021-05-14 20:05:35
tags:
    - 数学分析
    - 函数积分
    - Riemann积分
categories: 数学
mathjax: true
---

#### 定理1
> 设函数$f$在$[a,b]$上Riemann可积，则$f$在$[a,b]$上有界。

<!--more-->

证：设$f$在$[a,b]$上的积分为$I$，则由[函数积分二的定义2](https://gamersover.github.io/2021/04/28/函数积分2/#定义2：Riemann积分)可知，对$\varepsilon = 1$，必存在一个分割$\pi$，使得
$$
    \left| \sum_{i=1}^nf(\xi_i) \Delta x_i - I \right| < I
$$
这里值点$\xi_i \in [x_{i-1}, x_i] (1 \le i \le n)$可以任取，由上式可得
$$
    \left| \sum_{i=1}^n f(\xi_i) \Delta x_i \right| < |I| + 1
$$
从而有
$$
    |f(\xi_1)| \Delta x_1 < |I| + 1 + \left| \sum_{i=2}^n f(\xi_i) \Delta x_i \right|
$$
即
$$
    |f(\xi_i)| < \frac{1}{\Delta x_i} \left( |I| + 1 + \left| \sum_{i=2}^n f(\xi_i) \Delta x_i \right| \right)
$$
此时，把在$[x_{i-1}, x_i]$中的$\xi_i$固定下来$(i=2,3,\cdots,n)$，则上式右边是一个确定的正数，而$\xi_i$可以在$[x_0,x_1]$上任取，这就证明了$f$在区间$[x_0,x_1]$上有界。同理$f$在子区间$[x_{i-1},x_i] (i=2,3,\cdots,n)$上都是有界的，所以$f$在区间$[a,b]$上有界。

Q.E.D.


#### 定义1：振幅
> 设函数$f$在区间$[a,b]$上有界，用$M$与$m$分别表示$f$在$[a,b]$上的上确界和下确界，令$\omega = M - m$，称$\omega$为函数$f$在区间$[a,b]$上的振幅。


#### 定义2：上和与下和
> 设函数$f$在区间$[a,b]$上有界，对$[a,b]$上的任何分割
$$
    \pi : a = x_0 < x_1 < \cdots < x_n = b
$$
在$\pi$的第$i$个子区间$[x_i-1, x_i]$上$f$的上确界与下确界分别记为$M_i$与$m_i$，并令$\omega_i = M_i - m_i$，称$\omega_i$为$f$在$[x_{i-1}, x_i]$上的振幅，这里$i=1,2,\cdots,n$。定义
$$
    \overline S (f, \pi) = \sum_{i=1}^n M_i \Delta x_i, \quad \underline S(f, \pi) = \sum_{i=1}^n m_i \Delta x_i
$$
并分别称它们是$f$关于分割$\pi$的上和与下和。

#### 定理2
> 设$\pi$与$\pi^\prime$是$[a,b]$上的两个分割，其中$\pi^\prime$是在$\pi$的分点上多加了$k$个新的分点而成的，则
$$
    \begin{aligned}
    \underline S(f, \pi) \le \underline S(f, \pi^\prime) \le \underline S(f, \pi) + k\omega \Vert \pi \Vert \\
    \overline S (f, \pi) \ge \overline S(f, \pi^\prime) \ge \overline S(f, \pi) - k \omega \Vert \pi \Vert
    \end{aligned}
$$

证：首先考虑$k=1$的情况，即$\pi^\prime$是在$\pi$的分点上添加了1个新的分点，不失一般性，可设在第$i$个区间$[x_{i-1}, x_i]$内再加上一个分点$x^*$。即
$$
    \pi^\prime : a = x_0 < x_1 < \cdots x_{i-1} < x^* <  x_i < \cdots < a_n = b
$$
这时有
$$
    \begin{aligned}
    \underline S(f, \pi) - \underline S(f, \pi^\prime) &= m_i \Delta x_i - ((x^* - x_{i-1}) \inf f([x_{i-1}, x^*]) + (x_i - x^*) \inf f([x^*, x_i])) \\
    & \le m_i \Delta x_i - ((x^* - x_{i-1}) m_i + (x_i - x^*) m_i)  \\
    &= 0
    \end{aligned}
$$
即$ \underline S(f, \pi) \le \underline S(f, \pi^\prime) $，另一方面，显然有
$$
    \begin{aligned}
    \underline S(f, \pi) - \underline S(f, \pi^\prime) &= m_i \Delta x_i - ((x^* - x_{i-1}) \inf f([x_{i-1}, x^*]) + (x_i - x^*) \inf f([x^*, x_i])) \\
    & \ge m_i \Delta x_i - ((x^* - x_{i-1}) M_i + (x_i - x^*) M_i)  \\
    & = -\omega_i \Delta x_i \ge -\omega_i \Vert \pi \Vert \ge \omega \Vert \pi \Vert
    \end{aligned}
$$
即$ \underline S(f, \pi^\prime) \le \underline S(f, \pi) + \omega \Vert \pi \Vert$。
从而得到
$$
    \underline S(f, \pi) \le \underline S(f, \pi^\prime) \le \underline S(f, \pi) + \omega \Vert \pi \Vert
$$
类似地，可以得到
$$
    \overline S (f, \pi) \ge \overline S(f, \pi^\prime) \ge \overline S(f, \pi) - \omega \Vert \pi \Vert
$$

从而，易知当$k$为愿意正整数时，结论成立。

Q.E.D.


#### 定理3
> 对于任意两个分割，一个分割的下和总是不超过另一个分割的上和。

证：设$\pi_1$与$\pi_2$是$[a,b]$上的两个分割，如果$\pi_1$的所有分点都是$\pi_2$的分点，则称分割$\pi_2$比$\pi_1$更细或者分割$\pi_1$比$\pi_2$更粗，记为$\pi_1 \le \pi_2$；将$\pi_1$的分点与$\pi_2$的分点合并组成新的分割记为$\pi = \pi_1 + \pi_2$，则显然有$\pi_1 + \pi_2 \le \pi_i (i=1,2)$，则由[定理2](https://gamersover.github.io/2021/05/14/函数积分3/#定理2)可知
$$
    \underline S(f, \pi_1) \le \underline S(f, \pi) \le \overline S(f, \pi) \le \overline S(f, \pi_2)
$$

Q.E.D.

#### 定义3：上积分和下积分
> 所有上和组成的集合有下界，从而有下确界，用$\overline I$表示上和的下确界，并称之为$f$在$[a,b]$上的上积分；所有下和组成的集合有上界，从而有上确界，用$\underline I$表示下和的上确界，并称之为$f$在$[a,b]$上的下积分；并有
$$
    \underline f(f, \pi_1) \le \underline I \le \overline I \le \overline S(f, \pi_2)
$$
这里$\pi_1$与$\pi_2$是$[a,b]$上的任意两个分割。


#### 定理4：Darboux
> 对$[a,b]$上的任意有界函数，有
$$
    \lim \limits_{\Vert \pi \Vert \to 0} \overline S(f, \pi) = \overline I, \quad  \lim \limits_{\Vert \pi \Vert \to 0} \underline S(f, \pi) = \underline I
$$

证：这里证明第二个等式，第一个等式的证明方法类似。按照定义，有
$$
    \underline I = \sup_m  \underline S(f, \pi)
$$
从而对任意的$\varepsilon > 0$，存在$[a,b]$上的一个分割$\pi_0$，使得
$$
    \underline S (f, \pi_0) > \underline I - \frac{\varepsilon}{2}
$$
设$\pi_0$有$l$个内分点，将$\pi_0$和$\pi$的分点组合称新的分割$\pi^\prime$，则$\pi^\prime$是在$\pi$的分点基础上至多添加了$l$个分点的分割，从而由[定理2](https://gamersover.github.io/2021/05/14/函数积分3/#定理2)可知，
$$
    \underline S(f, \pi^\prime) \le \underline S(f, \pi) + l\omega \Vert \pi \Vert
$$
则
$$
    \underline S(f, \pi) \ge \underline S(f, \pi^\prime) - l\omega \Vert \pi \Vert \ge \underline S(f, \pi_0) - l\omega \Vert \pi \Vert > \underline I - \frac{\varepsilon}{2} - l\omega \Vert \pi \Vert
$$
即
$$
    \underline I - \underline S(f, \pi) < \frac{\varepsilon}{2} + l \omega \Vert \pi \Vert
$$
所以对任意$\varepsilon > 0$，只要有
$$
    \Vert \pi \Vert < \frac{\varepsilon}{2l\omega + 1}
$$
则
$$
    0 < \underline I - \underline S(f, \pi) < \frac{\varepsilon}{2} + \frac{\varepsilon}{2} = \varepsilon
$$
即
$$
    \lim \limits_{\Vert \pi \Vert \to 0} \underline S(f, \pi) = \underline I
$$

Q.E.D.

#### 定理5
> 设函数$f:[a,b] \to \mathbb{R}$有界，则以下三个条件互相等价： <br/>
（1）$f$在$[a,b]$上可积； <br/>
（2）$\displaystyle \lim \limits_{\Vert \pi \Vert \to 0} \sum_{i=1}^n \omega_i \Delta x_i = 0$，其中$\omega_i = M_i - m_i$是$f$在$[x_{i-1}, x_i] (i=1,2,\cdots,n)$上的振幅； <br/>
（3）$\underline I = \overline I$。

证：$(1)\Rightarrow (2)$
设$f$在$[a,b]$上的积分值为$I$，则对任意的$\varepsilon > 0$，存在$\delta > 0$，使得对任意满足$\Vert \pi \Vert < \delta$的分割$\pi$，有
$$
    I - \frac{\varepsilon}{3} < \sum_{i=1}^n f(\xi_i) \Delta x_i < I + \frac{\varepsilon}{3}
$$
对一切值点$\xi_i \in [x_{i-1}, x_i] (i=1,2,\cdots,n)$成立，从而有
$$
    I - \frac{\varepsilon}{3} \le \underline S(f, \pi) \le \overline S(f, \pi) \le I - \frac{\varepsilon}{3}
$$
从而有
$$
    0 < \sum_{i=1}^n \omega_i \Delta x_i \le I - \frac{2}{3}\varepsilon < \varepsilon
$$
$(2)\Rightarrow (3)$
若（2）成立，则有
$$
    0 \le \overline I - \underline I \le \overline S(f, \pi) - \underline S(f, \pi) = \sum \limits_{i=1}^n \omega_i \Delta x_i < \varepsilon
$$
由于$\varepsilon$是任何的正数，所以$\overline I = \underline I$。
$(3) \Rightarrow (1)$
设$\overline I = \underline I = I$，则对任意的分割$\pi$，有
$$
    \underline S(f, \pi) \le \sum_{i=1}^n f(\xi_i) \Delta x_i \le \overline S(f, \pi)
$$
两边同时取极限$\Vert \pi \Vert \to 0$，得到
$$
    \underline I \le \lim \limits_{\Vert \pi \Vert \to 0} \sum_{i=1}^n f(\xi_i) \Delta x_i \le \overline I
$$
所以
$$
    \lim \limits_{\Vert \pi \Vert \to 0} \sum_{i=1}^n f(\xi_i) \Delta x_i = I
$$
即$f$在$[a,b]$上可积。

Q.E.D.

#### 定理6
> 设$f$是定义在$[a,b]$上的单调函数，则$f$在$[a,b]$上可积。

证：不失一般性，不妨设$f$是递增函数，若$f(a)=f(b)$，则$f$在$[a,b]$上是常数，显然可积。下面设$f(b) > f(a)$，对任意给定的$\varepsilon > 0$，有
$$
    \begin{aligned} 
        0 & \le \sum_{i=1}^n \omega_i \Delta x_i = \sum \limits_{i=1}^n (M_i - m_i) \Delta x_i \\
        & \le \sum_{i=1}^n (f(x_i) - f(x_{i-1})) \Delta x_i \\
        & \le \Vert \pi \Vert (f(b) - f(a))
    \end{aligned}
$$
所以取$\displaystyle \delta = \frac{\varepsilon}{f(b) - f(a)}$，只要分割$\pi$满足$\Vert \pi \Vert < \delta$，就有
$$
    0 < \sum \limits_{i=1}^n \omega_i \Delta x_i < \varepsilon
$$
所以$f$在$[a,b]$上可积。

Q.E.D.

#### 定理7
> 设$f: [a,b] \to \mathbb{R}$是连续函数，则$f$在$[a,b]$上可积。

证：由于$f$在$[a,b]$上一致连续，所以对任意给定的$\varepsilon > 0$，必有$\delta > 0$，使得当$s, t \in [a,b]$且$|s - t| < \delta$时，有
$$
    |f(s) - f(t)| < \frac{\varepsilon}{b - a}
$$
对$[a,b]$上的一个分割
$$
    \pi: a = x_0 < x_1 < \cdots < x_n = b
$$
设
$$
    M_i = f(s_i), \quad m_i = f(t_i)
$$
其中$s_i, t_i \in [x_{i-1}, x_i] (i=1,2,\cdots,n)$，只要$\Vert \pi \Vert < \delta$，就有
$$
    |s_i - t_i| \le \Delta x_i \le \Vert \pi \Vert < \delta
$$
从而有
$$
    \begin{aligned} 
    \sum_{i=1}^n \omega_i \Delta x_i = \sum \limits_{i=1}^n (M_i - m_i) \Delta x_i &= \sum \limits_{i=1}^n (f(s_i) - f(t_i)) \Delta x_i \\
    & < \frac{\varepsilon}{b - a} \sum_{i=1}^n \Delta x_i = \varepsilon
    \end{aligned}
$$
所以$f$在$[a,b]$上可积。
