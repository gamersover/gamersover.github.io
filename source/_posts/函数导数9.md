---
title: 函数导数九：映射微分和复合求导
date: 2021-04-11 22:30:39
tags:
    - 数学分析
    - 函数导数
    - 映射
    - 微分
categories: 数学
mathjax: true
---

设开集$D \subset \mathbb{R}^n$，$\boldsymbol{f}: D \to \mathbb{R}^m$。记$\boldsymbol{f}$的分量依次为$f_1,f_2,\cdots,f_m$，可以把$\boldsymbol{f}(\boldsymbol{x})$写成
$$
    \boldsymbol{f(x)} = \left(
        \begin{matrix} 
            f_1(\boldsymbol{x}) \\
            f_2(\boldsymbol{x}) \\
            \vdots \\
            f_m(\boldsymbol{x})
        \end{matrix} 
    \right) \quad (\boldsymbol{x} \in D)
$$
设点$\boldsymbol{x}_0 \in D, \boldsymbol{h} \in \mathbb{R}^n$。由于$\boldsymbol{x}_0$是$D$的内点，所以总可以找到充分小的$\Vert \boldsymbol{h} \Vert$使得$\boldsymbol{x}_0 + \boldsymbol{h} \in D$。

<!--more-->

#### 定义1
> 如果映射$\boldsymbol{f}$满足
$$
    \boldsymbol{f}(\boldsymbol{x}_0 + \boldsymbol{h}) - \boldsymbol{f}(\boldsymbol{x}_0) = \boldsymbol{Ah} + \boldsymbol{r}(\boldsymbol{h})
$$
式中$\boldsymbol{A}$是一个$m \times n$矩阵，它的元素不依赖于$\boldsymbol{h}$，且
$$
    \lim \limits_{\boldsymbol{h} \to \boldsymbol{0}} \frac{\Vert \boldsymbol{r}(\boldsymbol{h}) \Vert}{\Vert \boldsymbol{h} \Vert} = 0
$$
则称映射$\boldsymbol{f}$在点$\boldsymbol{x}_0$处可微，并称$\boldsymbol{Ah}$是$\boldsymbol{f}$在点$\boldsymbol{x}_0$处的微分，记作
$$
    \mathrm{d}\boldsymbol{f}(\boldsymbol{x}_0) = \boldsymbol{Ah}
$$


#### 定理1
> 若映射$\boldsymbol{f}$在点$\boldsymbol{x}_0$处可微，则有
$$
    \mathrm{d}\boldsymbol{f}(\boldsymbol{x}_0) = \boldsymbol{Jf}(\boldsymbol{x}_0)\boldsymbol{h}
$$
其中
$$
    \boldsymbol{Jf}(\boldsymbol{x}_0) = \left[
        \begin{matrix}
            \frac{\partial f_1(\boldsymbol{x}_0)}{\partial x_1}  & \cdots & \frac{\partial f_1(\boldsymbol{x}_0)}{\partial x_n} \\
            \vdots & & \vdots \\
            \frac{\partial f_m(\boldsymbol{x}_0)}{\partial x_1}  & \cdots & \frac{\partial f_m(\boldsymbol{x}_0)}{\partial x_n}
        \end{matrix}
    \right]
$$
称之为映射$\boldsymbol{f}$在点$\boldsymbol{x}_0$处的Jacobi矩阵，也称为导数。

证：有定义可知，
$$
    \boldsymbol{f}(\boldsymbol{x}_0 + \boldsymbol{h}) - \boldsymbol{f}(\boldsymbol{x}_0) = \boldsymbol{Ah} + \boldsymbol{r}(\boldsymbol{h})
$$
设
$$
    \boldsymbol{A} = \left[\begin{matrix}
        a_{11} & \cdots & a_{1n} \\
        \vdots & & \vdots \\
        a_{m1} & \cdots & a_{mn}
    \end{matrix}\right] 
$$
将其代入上式中得
$$
    f_i(\boldsymbol{x}_0 + \boldsymbol{h}) - f_i(\boldsymbol{x}_0) = \sum_{j=1}^n a_{ij} h_j + r_i(\boldsymbol{h})
$$
其中$r_i(\boldsymbol{h})$表示$\boldsymbol{r}(\boldsymbol{h})$的第$i$个分量，由$\boldsymbol{r}(\boldsymbol{h})$的性质可知
$$
    r_i(\boldsymbol{h}) = o(\Vert \boldsymbol{h} \Vert) \quad (\boldsymbol{h} \to 0, i=1,2,\cdots,m)
$$
从而继续由[函数导数八定理1](todo)可知
$$
    a_{ij} = \frac{\partial f_i(\boldsymbol{x}_0)}{\partial x_j} (i=1,2,\cdots,m;j=1,2,\cdots,n)
$$
从而得证。

Q.E.D.

#### 定理2
> 若映射$\boldsymbol{f}$在点$\boldsymbol{x}_0$的某一领域内存在Jacobi矩阵$\boldsymbol{Jf}$，且$\boldsymbol{Jf}$的各元素在$\boldsymbol{x}_0$处都连续，则映射$\boldsymbol{f}$在点$\boldsymbol{x}_0$处可微。

证：由[定理1](todo)与[函数导数八的定理2](todo)易证。

Q.E.D.

#### 定义2
> 设开集$D \subset \mathbb{R}^n$，$\boldsymbol{f}: D \to \mathbb{R}^m$。如果$\boldsymbol{f}$在$D$上的每一点处都连续，则记$\boldsymbol{f} \in C(D)$；如果$\boldsymbol{Jf}$在$\boldsymbol{D}$上的每一点处都连续，则记$\boldsymbol{f} \in C^1(D)$。

#### 定理3
> 设开集$D \subset \mathbb{R}^n$，$\boldsymbol{g}: D \to \mathbb{R}^m$，$\boldsymbol{g}$在点$\boldsymbol{x}_0 \in D$处可微，又设$\boldsymbol{f}$把包含$\boldsymbol{g}(D)$的一个开集映射至$\mathbb{R}^l$，并且$\boldsymbol{f}$在$\boldsymbol{g}(\boldsymbol{x}_0)$处可微，那么复合映射$\boldsymbol{f} \circ \boldsymbol{g}$在点$\boldsymbol{x}_0$处可微，并且
$$
    \boldsymbol{J}(\boldsymbol{f}\circ \boldsymbol{g})(\boldsymbol{x}_0) = \boldsymbol{Jf}(\boldsymbol{g}(\boldsymbol{x}_0)) \boldsymbol{Jg}(\boldsymbol{x}_0)
$$

证：令$\boldsymbol{y}_0 = \boldsymbol{g}(\boldsymbol{x}_0)$，$\boldsymbol{A} = \boldsymbol{Jf}(\boldsymbol{y}_0)，\boldsymbol{B} = \boldsymbol{Jg}(\boldsymbol{x}_0)$，易知$\boldsymbol{A}$是$l\times m$矩阵，$\boldsymbol{B}$是$m \times n$矩阵，从而若能证明
$$
    \lim \limits_{\Vert \boldsymbol{h} \Vert \to 0} \frac{\Vert (\boldsymbol{f} \circ \boldsymbol{g})(\boldsymbol{x}_0 + \boldsymbol{h}) - (\boldsymbol{f} \circ \boldsymbol{g})(\boldsymbol{x}_0) - \boldsymbol{ABh} \Vert}{\Vert \boldsymbol{h} \Vert} = 0 \tag{1}
$$    
则由[定义1](todo)可知，$\boldsymbol{J}(\boldsymbol{f}\circ \boldsymbol{g})(\boldsymbol{x}_0) = \boldsymbol{AB}$。<br/>
由于$\boldsymbol{g},\boldsymbol{f}$分别在$\boldsymbol{x}_0,\boldsymbol{y}_0$处可微，从而有
$$
    \begin{aligned}
    \boldsymbol{g}(\boldsymbol{x}_0 + \boldsymbol{h}) - \boldsymbol{g}(\boldsymbol{x}_0) = \boldsymbol{Bh} + \boldsymbol{u}(\boldsymbol{h}) \\
    \boldsymbol{f}(\boldsymbol{y}_0 + \boldsymbol{k}) - \boldsymbol{f}(\boldsymbol{y}_0) = \boldsymbol{Ak} + \boldsymbol{v}(\boldsymbol{k}) 
    \end{aligned} \tag{2}
$$
其中$\boldsymbol{h}，\boldsymbol{k}$分别为$n \times 1$矩阵和$m \times 1$矩阵，且
$$
    \begin{aligned}
        \frac{\Vert \boldsymbol{u}(\boldsymbol{h}) \Vert}{\Vert \boldsymbol{h} \Vert} \to 0 \quad (\Vert \boldsymbol{h} \Vert \to 0) \\
        \frac{\Vert \boldsymbol{v}(\boldsymbol{k}) \Vert}{\Vert \boldsymbol{k} \Vert} \to 0 \quad (\Vert \boldsymbol{k} \Vert \to 0)
    \end{aligned} 
$$
记
$$
    \frac{\Vert \boldsymbol{u}(\boldsymbol{h}) \Vert}{\Vert \boldsymbol{h} \Vert} = \varepsilon(\boldsymbol{h})， \quad \frac{\Vert \boldsymbol{v}(\boldsymbol{h}) \Vert}{\Vert \boldsymbol{h} \Vert} = \eta(\boldsymbol{h})
$$
则
$$
    \Vert \boldsymbol{u}(\boldsymbol{h}) \Vert = \varepsilon(\boldsymbol{h}) \Vert \boldsymbol{h} \Vert， \quad \Vert \boldsymbol{v}(\boldsymbol{k}) \Vert = \eta(\boldsymbol{k}) \Vert \boldsymbol{k} \Vert
$$
且
$$
    \lim \limits_{\Vert \boldsymbol{h} \Vert \to 0} \varepsilon(\boldsymbol{h}) = 0， \quad \lim \limits_{\Vert \boldsymbol{k} \Vert \to 0} \eta(\boldsymbol{k}) = 0 \tag{3}
$$
对给定的$\boldsymbol{h}$，令$\boldsymbol{k} = \boldsymbol{g}(\boldsymbol{x}_0 + \boldsymbol{h}) - \boldsymbol{g}(\boldsymbol{x}_0)$，由式(2)可得
$$
    \Vert \boldsymbol{k} \Vert \le \Vert \boldsymbol{Bh} \Vert + \Vert \boldsymbol{u}(\boldsymbol{h})\Vert \le \Vert \boldsymbol{B} + \varepsilon(\boldsymbol{h}) \Vert \Vert \boldsymbol{h} \Vert
$$
从而有
$$
    \begin{aligned}
        & \Vert \boldsymbol{f} \circ \boldsymbol{g} (\boldsymbol{x}_0 + \boldsymbol{h}) - \boldsymbol{f} \circ \boldsymbol{g} (\boldsymbol{x}_0) - \boldsymbol{ABh} \Vert \\
        & = \Vert \boldsymbol{f}(\boldsymbol{g} (\boldsymbol{x}_0 + \boldsymbol{h})) - \boldsymbol{f}(\boldsymbol{g} (\boldsymbol{x}_0)) - \boldsymbol{ABh} \Vert \\
        & = \Vert \boldsymbol{f}(\boldsymbol{y}_0 + \boldsymbol{k}) - \boldsymbol{f}(\boldsymbol{y}_0) - \boldsymbol{ABh} \Vert \\
        & = \Vert \boldsymbol{Ak} + \boldsymbol{v}(\boldsymbol{k}) - \boldsymbol{ABh} \Vert \\
        & = \Vert \boldsymbol{A}(\boldsymbol{k} - \boldsymbol{Bh}) + \boldsymbol{v}{\boldsymbol{k}} \Vert \\
        & \le \Vert \boldsymbol{A} \Vert u(\boldsymbol{h}) + \eta(\boldsymbol{k})\Vert \boldsymbol{k} \Vert \\
        & \le \Vert \boldsymbol{A} \Vert \varepsilon(\boldsymbol{h}) \Vert \boldsymbol{h} \Vert + \eta(\boldsymbol{k})(\Vert \boldsymbol{B} \Vert + \varepsilon(\boldsymbol{h})) \Vert \boldsymbol{h} \Vert
    \end{aligned}
$$
所以
$$
    \frac{\Vert (\boldsymbol{f} \circ \boldsymbol{g})(\boldsymbol{x}_0 + \boldsymbol{h}) - (\boldsymbol{f} \circ \boldsymbol{g})(\boldsymbol{x}_0) - \boldsymbol{ABh} \Vert}{\Vert \boldsymbol{h} \Vert} \le \Vert \boldsymbol{A} \Vert \varepsilon(\boldsymbol{h}) + \eta(\boldsymbol{k})(\Vert \boldsymbol{B} \Vert + \varepsilon(\boldsymbol{h}))
$$
再由式(3)可知式(1)成立。