---
title: 函数导数五：函数性质与导数的关系
date: 2021-03-08 20:29:52
tags:
    - 函数导数
    - 数学分析
    - 函数单调性
    - 函数极值
    - 函数凸性
categories: 数学
mathjax: true
---

#### 定理1
> 设函数$f$在区间$[a,b]$上连续，在$(a,b)$上可导，那么$f$在$[a,b]$上递增（减）的充分必要条件是$f^\prime \ge 0 (\le 0)$在区间$(a,b)$上成立。

<!--more-->

证：必要性。设$f$在$[a,b]$上递增，任取一点$x \in (a,b)$，对能使$x + h \in (a,b)$的一切$h$，都有
$$
    \frac{f(x+h) - f(x)}{h} \ge 0
$$
令$h \to 0$，得$f^\prime(x) \ge 0 (a < x < b)$。
类似地，当$f$在$[a,b]$上递减时，可以推出$f^\prime(x) \ge 0$对$x \in (a,b)$成立。

充分性。设在$(a,b)$上$f^\prime \ge 0$，对任何$x_1, x_2 \in [a,b]$且$x_1 < x_2$，由Lagrange中值定理可知，
$$
    f(x_2) - f(x_1) = f^\prime(\xi) (x_2 - x_1)
$$
其中$\xi \in (x_1,x_2) \in (a,b)$，由于$f^\prime(\xi) \ge 0$，从而$f(x_2) \ge f(x_1)$。
类似地，当在$(a,b)$上$f^\prime \le 0$时，对任何$x_1,x_2 \in [a,b]$且$x_1 < x_2$，可以推出$f(x_1) \ge f(x_2)$。

Q.E.D.

#### 定理2
> 设函数$f$在区间$[a,b]$上连续，在$(a,b)$上可导，如果$f^\prime > 0 (< 0)$在区间$(a,b)$上成立。那么$f$在$[a,b]$上严格递增（严格递减）的。

证：证法与[定理1](https://gamersover.github.io/2021/03/08/%E5%87%BD%E6%95%B0%E5%AF%BC%E6%95%B05/#%E5%AE%9A%E7%90%861)一样。

Q.E.D.

#### 定理3
> 设函数$f$在区间$[a,b]$上连续，在$(a,b)$上可导，在区间$(a,b)$内，除了有限个点之外，$f^\prime > 0 (< 0)$成立。那么$f$在$[a,b]$上严格递增（严格递减）的。

证。设除了点$x_1,x_2,\cdots,x_n \in (a,b)$外，$f^\prime > 0$，这里$x_1 < x_2 < \cdots < x_n$，$f$在区间$[a,x_1],[x_1,x_2],\cdots,[x_n,b]$上都是连续的，且$f^\prime > 0$，因此在$[a,x_1],[x_1,x_2],\cdots,[x_n,b]$的每一个区间上都是严格递增的，因此在$[a,b]$上也是严格递增的。
类似地，递减也可证。

Q.E.D.

#### 定理4
> 设函数$f$在区间$[a,b]$上连续，在$(a,b)$上可导，那么$f$在$[a,b]$上严格递增（严格递减）的充分必要条件是：<br/>
（1）当$x \in (a,b)$时，$f^\prime \ge 0 (f^\prime \le 0)$；<br/>
（2）在$(a,b)$的任何开子区间上，$f^\prime \ne 0$。

证：必要性。由[定理1](https://gamersover.github.io/2021/03/08/%E5%87%BD%E6%95%B0%E5%AF%BC%E6%95%B05/#%E5%AE%9A%E7%90%861)可知，（1）是必要的，假如（2）不正确，则存在一个被$(a,b)$包含的开区间，在其上$f^\prime = 0$，那么在这个开区间上$f$为常数，因此$f$在$[a,b]$上不是严格单调的，从而（2）必然正确。

充分性。设（1）（2）同时成立，由（1）和[定理1](https://gamersover.github.io/2021/03/08/%E5%87%BD%E6%95%B0%E5%AF%BC%E6%95%B05/#%E5%AE%9A%E7%90%861)可知，$f$是单调的，若有$x_1,x_2 \in [a,b]$，其中$x_1 < x_2$，使得$f(x_1) = f(x_2)$，那么对$x \in [x_1, x_2]$，有$f(x_1) = f(x) = f(x_2)$。从而对$x \in (x_1,x_2)$，有$f^\prime = 0$，这与（2）矛盾，从而$f$在$[a,b]$上严格单调。

Q.E.D.

#### 定理5
> 设函数$f$在$[a,b]$上连续，$x_0 \in (a,b)$；<br/>
（1）如果存在正数$\delta > 0$，使得在$(x_0 - \delta, x_0)$上$f^\prime > 0$，而在$(x_0, x_0 + \delta)$上$f^\prime < 0$，那么$f(x_0)$是$f$的一个严格极大值，所谓严格极大值是指，当$0 < |x - x_0| < \delta$时，$f(x) < f(x_0)$；
（2）如果存在正数$\delta > 0$，使得在$(x_0 - \delta, x_0)$上$f^\prime < 0$，而在$(x_0, x_0 + \delta)$上$f^\prime > 0$，那么$f(x_0)$是$f$的一个严格极小值，所谓严格极小值是指，当$0 < |x - x_0| < \delta$时，$f(x) > f(x_0)$；

证：这里只证（1），（2）是同样的证法。由[定理2](https://gamersover.github.io/2021/03/08/%E5%87%BD%E6%95%B0%E5%AF%BC%E6%95%B05/#%E5%AE%9A%E7%90%862)可知，$f$在$[x_0-\delta, x_0]$上严格递增，所以当$x \in (x_0-\delta, x_0)$时，$f(x) < f(x_0)$，而$f$在$[x_0, x_0+\delta]$上严格递减，所以当$x \in (x_0, x_0 + \delta)$时，$f(x) < f(x_0)$，即$f(x_0)$是一个严格极大值。

Q.E.D.

#### 定理6
> 设$f$在$[a,b]$上连续，$x_0 \in (a,b)$是$f$的一个驻点，进一步假设$f^{\prime\prime}(x_0)$存在，那么 <br/>
（1）当$f^{\prime\prime} < 0$时，$f(x_0)$是$f$的一个严格极大值； <br/>
（2）当$f^{\prime\prime} > 0$时，$f(x_0)$是$f$的一个严格极小值。

证：这里只证（1），（2）是同样的证法。因为
$$
    f^{\prime\prime}(x_0) = \lim \limits_{x \to x_0} \frac{f^\prime(x) - f^\prime(x_0)}{x - x_0} = \lim\limits_{x \to x_0} \frac{f^\prime(x)}{x-x_0} < 0
$$
从而存在一个$\delta > 0$，使得当$0 < |x - x_0| < \delta$时，有
$$
    \frac{f^\prime(x)}{x - x_0} < 0
$$
所以，当$x \in (x_0, x_0 + \delta)$时，$f^\prime(x) < 0$；而当$x \in (x_0 - \delta, x_0)$时，$f^\prime(x) > 0$，即$f(x_0)$是$f$的一个严格极大值。

Q.E.D.

#### 定义1：凸函数
> 设函数$f$在区间$I$上有定义，如果对任何$x_1,x_2 \in I$，$x_1\ne x_2$，以及任意的$\lambda_1,\lambda_2 > 0$，且$\lambda_1 + \lambda_2 = 1$，都有
$$
    f(\lambda_1 x_1 + \lambda_2 x_2) \le \lambda_1 f(x_1) + \lambda_2 f(x_2)
$$
则称$f$为$I$上的凸函数，如果上述不等式的不等号总成立，则称$f$为$I$上的严格凸函数。

#### 定理7
> 设$f$在区间$I$上是凸函数，则对任何的$x_1,x_2,\cdots,x_n \in I$，以及$\lambda_1,\lambda_2,\cdots,\lambda_n > 0$，且$\lambda _1+\lambda _2+\cdots+\lambda_n = 1$，都有
$$
    f(\sum_{i=1}^n \lambda_i x_i) \le \sum_{i=1}^n \lambda_i f(x_i)
$$
如果$f$是$I$上的严格凸函数，则当$x_1,x_2,\cdots,x_n$不全相等时，有
$$
    f(\sum_{i=1}^n \lambda_i x_i) < \sum_{i=1}^n \lambda_i f(x_i)
$$

证：使用数学归纳法。当$n=2$时，由凸函数定义知显然成立；设$n = k$时命题成立，现在证$n = k+1$时命题也成立。设$x_1,x_2,\cdots,x_{k+1} \in I$，$\lambda_1,\lambda_2,\cdots,\lambda_{k+1} > 0$，并且$\lambda_1 + \lambda_2 + \cdots + \lambda_{k+1} = 1$，知
$$
    \lambda_1 + \lambda_2 + \cdots + \lambda_k = 1 - \lambda_{k+1} \Rightarrow \frac{\lambda_1}{1-\lambda_{k+1}} + \frac{\lambda_2}{1-\lambda_{k+1}} + \cdots + \frac{\lambda_k}{1-\lambda_{k+1}} = 1
$$
令$u_i = \frac{\lambda_i}{1-\lambda_{k+1}} (i=1,2\cdots,k)$，从而有
$$
    \begin{aligned}
        f(\sum_{i=1}^{k+1} \lambda_i x_i) & = f\left((1-\lambda_{k+1})\sum_{i=1}^k u_i x_i + \lambda_{k+1}x_{k+1}\right) \\
        & \le (1-\lambda_{k+1}) f(\sum_{i=1}^k u_ix_i) + \lambda_{k+1} f(x_{k+1}) \\
        & \le (1-\lambda_{k+1}) \sum_{i=1}^k u_i f(x_i) + \lambda_{k+1} f(x_{k+1}) \\
        & = \sum_{i=1}^{k+1} \lambda_i f(x_i)
    \end{aligned}
$$
从而当$f$为$I$上的凸函数时，对任何$n \in \mathbb{N^{*}}$，不等式都成立。

再设$f$是$I$上的严格凸函数，同样当$n=2$时，自然严格不等号成立。假设当$n=k$时，严格不等号成立。现设$x_1,x_2,\cdots,x_{k+1}$不全相等，有两种情况：<br/>
（1）$x_1,x_2,\cdots,x_k$不全相等，则此时上述归纳法的最后一个不等号是严格的，
（2）$x_1=x_2=\cdots=x_k \ne x_{k+1}$，则
$$
    \sum_{i=1}^k u_ix_i = x_1 \ne x_{k+1}
$$
此时上述归纳法的第一个不等号是严格的。从而对任何$n \in \mathbb{N^*}$，最终不等式都是严格的。

Q.E.D.

#### 定理8：Jensen不等式
> 设$f$在区间$I$上是凸函数，则对任何$x_1,x_2,\cdots,x_n \in I$，以及对任何的正数$\beta_1,\beta_2,\cdots,\beta_n$，有不等式
$$
    f(\sum_{i=1}^n \beta_i x_i / \sum_{i=1}^n \beta_n) \le \frac{\sum\limits_{i=1}^n \beta_i f(x_i)}{\sum\limits_{i=1}^n \beta_i}
$$

证：令
$$
    \lambda_i = \frac{\beta_i}{\sum\limits_{i=1}^n \beta_i} \quad (i=1,2,\cdots,n)
$$
再由[定理7](todo)可证。

Q.E.D.

#### 定理9
> 函数$f$在区间$I$是凸函数，当且仅当对任何$(x_1,x_2) \in I$及任何$x \in (x_1,x_2)$，有
$$
    \frac{f(x) - f(x_1)}{x - x_1} \le \frac{f(x_2) - f(x_1)}{x_2 - x_1} \le \frac{f(x_2) - f(x)}{x_2 - x}
$$
若$f$是严格凸函数，当且仅当上述不等式是严格的。

证：必要性。记
$$
    \lambda_1 = \frac{x_2 - x}{x_2 - x_1} \qquad \lambda_2 = \frac{x - x_1}{x_2 - x_1}
$$
则有$\lambda_1 > 0, \lambda_2 > 0, \lambda_1 + \lambda_2 = 1$，且$x = \lambda_1 x_1 + \lambda_2 x_2$，
由凸函数的定义可知
$$
    \lambda_1 f(x) + \lambda_2 f(x) = f(x) = f(\lambda_1 x_1 + \lambda_2 x_2) \le \lambda_1 f(x_1) + \lambda_2 f(x_2)
$$
可得
$$
    \lambda_1 (f(x) - f(x_1)) \le \lambda_2 (f(x_2) - f(x)) \Rightarrow \frac{f(x) - f(x_1)}{x - x_1} \le \frac{f(x_2) - f(x)}{x_2 - x}
$$

又易证得：若$b>0,d>0,a/b \le c/d$，则有
$$
\frac{a}{b} \le \frac{a+c}{b+d} \le \frac{c}{d}
$$
由以上性质，易得要证不等式成立，若$f$是严格凸函数，那么上述证明中得不等号都是严格的。

充分性。必要性的证明倒推回去即可证。

Q.E.D.