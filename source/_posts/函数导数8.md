---
title: 函数导数八：多变量函数的微分
date: 2021-03-31 21:04:32
tags:
    - 函数微分
    - 方向导数
    - 偏导数
    - 梯度
    - Jacobi矩阵
categories: 数学
mathjax: true
---

#### 定义1
> 设开集$D \subset \mathbb{R}^n$，$f: D \to \mathbb{R}$，$\boldsymbol{u}$是一个方向，$x_0 \in D$，如果极限
$$
    \lim \limits_{t \to 0} \frac{f(\boldsymbol{x}_0 + t\boldsymbol{u}) - f(\boldsymbol{x})}{t}
$$
存在且有限，则称这个极限为函数$f$在$\boldsymbol{x}_0$处沿方向$u$的方向导数，记为$\frac{\partial f}{\partial \boldsymbol{u}}(\boldsymbol{x}_0)$。


#### 定义2
> 记单位坐标向量
$$
    \begin{aligned}
        & \boldsymbol{e}_1 = (1, 0, 0, \cdots, 0) \\
        & \boldsymbol{e}_2 = (0, 1, 0, \cdots, 0) \\
        & \cdots \\
        & \boldsymbol{e}_n = (0, 0, 0, \cdots, 1)
    \end{aligned}
$$
称函数$f$在点$\boldsymbol{x}_0$处沿方向$\boldsymbol{e}_i$的方向导数为$f$在$\boldsymbol{x}_0$处的第$i$个一阶偏导数，记作
$$
    \frac{\partial f}{\partial x_i} (\boldsymbol{x}_0) 或 \mathrm{D}_if(\boldsymbol{x}_0)
$$
并称$\mathrm{D}_i = \frac{\partial}{\partial x_i}$为第$i$个偏微分算子$(i=1,2,\cdots,n)$；令
$$
    \boldsymbol{J}f(\boldsymbol{x}) = (\mathrm{D_1}f(\boldsymbol{x}),\mathrm{D_2}f(\boldsymbol{x}),\cdots,\mathrm{D_n}f(\boldsymbol{x}))
$$
并称它为函数$f$在点$\boldsymbol{x}$处的Jacobi矩阵$1 \times n$矩阵。Jacobi矩阵也常记作$\mathrm{grad} f$或$\nabla f$，也称为数量函数$f$的梯度。


---
设开集$D \subset \mathbb{R}^n$，$f: D \to \mathbb{R}$，取定一点$\boldsymbol{x}_0 \in D$，$\boldsymbol{h} \in \mathbb{R}^n$。由于$\boldsymbol{x}_0$是$D$的一个内点，故当$\Vert \boldsymbol{h} \Vert$充分小时，可以使$\boldsymbol{x}_0+\boldsymbol{h}$完全在$D$之内。

#### 定义3
> 设$\boldsymbol{h}=(h_1,h_2,\cdots,h_n)$，如果成立
$$
    f(\boldsymbol{x}_0 + \boldsymbol{h}) - f(\boldsymbol{x}_0) = \sum_{i=1}^n \lambda_i h_i + o(\Vert \boldsymbol{h} \Vert) \quad (\Vert \boldsymbol{h} \Vert \to 0)
$$
其中$\lambda_i(i=1,2,\cdots,n)$是不依赖于$\boldsymbol{h}$的常数，那么称函数$f$在点$\boldsymbol{x}_0$处可微，并称$\sum \limits_{i=1}^n \lambda_i h_i$为$f$在$\boldsymbol{x}_0$处的微分，记作
$$
    \mathrm{d}f(\boldsymbol{x}_0) (\boldsymbol{h}) = \sum_{i=1}^n \lambda_i h_i
$$
如果$f$在开集$D$上的每一点处都可微，则称$f$是$D$上的可微函数。

#### 定理1
> 为了方便，将$\boldsymbol{x}_0,\boldsymbol{h}$表示列向量形式，设函数$f$在$\boldsymbol{x}_0 = (x_1,x_2,\cdots,x_n)^T$处可微，则
$$
    \mathrm{d}f(\boldsymbol{x}_0) (\boldsymbol{h}) = \boldsymbol{J}f(\boldsymbol{x_0}) \boldsymbol{h}
$$


证：定义3中令$\boldsymbol{h} = (h_1,0,\cdots, 0)^T$，此时
$$
    f(x_1+h_1, x_2, \cdots, x_n) - f(x_1,x_2,\cdots,x_n) = \lambda_1 h_1 + o(|h_1|)
$$
从而
$$
    \frac{f(x_1+h_1, x_2, \cdots, x_n) - f(x_1,x_2,\cdots,x_n)}{h_1} = \lambda_1 + o(1)
$$
令$h_1 \to 0$，得
$$
    \lambda_1 = \mathrm{D}_1f(\boldsymbol{x}_0)
$$
一般地，有
$$
    \lambda_i = \mathrm{D}_if(\boldsymbol{x}_0) \quad (i=1,2,\cdots,n)
$$
所以有
$$
    \mathrm{d}f(\boldsymbol{x}_0) (\boldsymbol{h}) = \boldsymbol{J}f(\boldsymbol{x_0}) \boldsymbol{h}
$$
Q.E.D.

#### 定理2
> 设$f$在$\boldsymbol{x}_0$处可微，则$f$必在$\boldsymbol{x}_0$处连续。

证：由于$f$在$\boldsymbol{x}_0$处可微，当$\boldsymbol{h} \to \boldsymbol{0}$时，有$h_i \to 0 (i=1,2,\cdots,n)$，此时$\mathrm{d}f(\boldsymbol{x}_0) (\boldsymbol{h}) = \sum \limits_{i=1}^n \lambda_i h_i \to 0$，从而$f(\boldsymbol{x_0} + \boldsymbol{h}) - f(\boldsymbol{x}_0) \to 0$，所以$f$在$\boldsymbol{x}_0$处连续。
Q.E.D.

#### 定理3
> 函数$f$在$\boldsymbol{x}_0$处可微当且仅当等式
$$
    f(\boldsymbol{x}_0 + \boldsymbol{h}) - f(\boldsymbol{x}_0) = \boldsymbol{J}f(\boldsymbol{x}_0) \boldsymbol{h} + \sum_{i=1}^n \beta_i(\boldsymbol{h}) h_i
$$
成立。其中，当$\Vert \boldsymbol{h} \Vert \to 0$时，
$$
    \beta_i(\boldsymbol{h}) \to 0 \quad (i=1,2,\cdots,n)
$$

证：充分性。当$\boldsymbol{h} \to \boldsymbol{0}$时，有
$$
    \frac{1}{\Vert \boldsymbol{h} \Vert} |\sum_{i=1}^n \beta_i(\boldsymbol{h})h_i| = \left| \sum_{i=1}^n \beta_i(\boldsymbol{h}) \frac{h_i}{\boldsymbol{\Vert h \Vert}} \right| \le \left| \sum_{i=1}^n \beta_i(\boldsymbol{h}) \right| \to 0
$$
即
$$
    \sum_{i=1}^n \beta_i(\boldsymbol{h}) h_i = o(\Vert \boldsymbol{h} \Vert)
$$
有定义3可知，函数$f$在$\boldsymbol{x}_0$处可微。 <br/>
必要性。记
$$
    r(\boldsymbol{h}) = f(\boldsymbol{x}_0 + \boldsymbol{h}) - f(\boldsymbol{x}_0) - \boldsymbol{J}f(\boldsymbol{x_0}) \boldsymbol{h}
$$
可知当$\Vert \boldsymbol{h} \Vert \to 0$时，有$r(\boldsymbol{h}) = o(\Vert \boldsymbol{h} \Vert)$，由于
$$
    r(\boldsymbol{h}) = \left(\sum_{i=1}^n \frac{h_i}{\Vert \boldsymbol{h} \Vert} h_i \right)\frac{r(\boldsymbol{h})}{\Vert \boldsymbol{h} \Vert}
$$
故令
$$
    \beta_i(\boldsymbol{h}) = \frac{r(\boldsymbol{h})}{\Vert \boldsymbol{h} \Vert} \frac{h_i}{\Vert \boldsymbol{h} \Vert}
$$
由于
$$
    \frac{h_i}{\Vert \boldsymbol{h} \Vert} \le 1 \quad (i=1,2,\cdots,n)
$$
从而可知$\beta_i(\boldsymbol{h}) \to 0$，且
$$
    f(\boldsymbol{x}_0 + \boldsymbol{h}) - f(\boldsymbol{x}_0) = \boldsymbol{J}f(\boldsymbol{x}_0) \boldsymbol{h} + \sum_{i=1}^n \beta_i(\boldsymbol{h}) h_i
$$

Q.E.D.

#### 定理4
> 设开集$D \subset \mathbb{R}^n$，$f: D \to \mathbb{R}$，$\boldsymbol{x}_0 \in D$，如果$\mathrm{D}_if(\boldsymbol{x}) (i=1,2,\cdots,n)$在$\boldsymbol{x}_0$的一个领域中存在且在点$\boldsymbol{x}_0$处连续，则$f$在点$\boldsymbol{x}_0$处可微。

证：使用数学归纳法。当$n=1$时自然成立，因为单变量函数的导数存在即可微。设定理对$n-1$维成立，令
$$
    f(\boldsymbol{x}_0 + \boldsymbol{h}) - f(\boldsymbol{x}_0) = K_1 + K_2
$$
其中
$$
    \begin{aligned}
    & K_1 = f(x_1+h_1,x_2+h_2,\cdots,x_n+h_n) - f(x_1+h_1,\cdots,x_{n-1}+h_{n-1},x_n) \\
    & K_2 = f(x_1+h_1,\cdots,x_{n-1}+h_{n-1},x_n) - f(x_1,x_2,\cdots,x_n)
    \end{aligned}
$$
对$K_1$运用一元微分中值定理，得到
$$
    K_1 = \frac{\partial f}{\partial x_n}(x_1+h_1,\cdots,x_{n-1}+h_{n-1},x_n+\theta h_n) h_n
$$
其中$\theta \in (0, 1)$，可以令
$$
    K_1 = \frac{\partial f}{\partial x_n}(\boldsymbol{x}_0) h_n + r_1
$$
其中
$$
    \begin{aligned}
    r_1 & = \left( \frac{\partial f}{\partial x_n}(x_1+h_1,\cdots,x_{n-1}+h_{n-1},x_n+\theta h_n) - \frac{\partial f}{\partial x_n}(\boldsymbol{x}_0) \right) h_n \\
    & = \beta_n(\boldsymbol{h}) h_n
    \end{aligned}
$$
由$\frac{\partial f}{\partial x_n}$函数的连续性可知，当$\Vert \boldsymbol{h} \Vert \to 0$时，$\beta_n(\boldsymbol{h}) \to 0$，从而
$$
    K_1 = \frac{\partial f}{\partial x_n}(\boldsymbol{x}_0)h_n + \beta_n(\boldsymbol{h})h_n
$$
对$K_2$使用$n-1$维的归纳假设，可知
$$
    K_2 = \sum_{i=1}^{n-1} \frac{\partial f}{\partial x_i} h_i + \sum_{i=1}^{n-1} \beta_i(\boldsymbol{h}) h_i
$$
当$\Vert \boldsymbol{h} \Vert \to 0$时，$\beta_i(\boldsymbol{h}) \to 0 (i=1,2,\cdots,n-1)$，从而
$$
    f(\boldsymbol{x}_0 + \boldsymbol{h}) - f(\boldsymbol{x}_0) = K_1+K_2 = \sum \limits_{i=1}^n \frac{\partial f}{\partial x_i} (\boldsymbol{x}_0) h_i + \sum_{i=1}^{n-1} \beta_i(\boldsymbol{h})h_i
$$
其中$\beta_i(\boldsymbol{h}) \to 0 (\Vert \boldsymbol{h} \Vert \to 0)(i=1,2,\cdots,n)$。所以$f$在$\boldsymbol{x}_0$处可微。即对$n$维定理也成立。

Q.E.D.

#### 定理5
> 若$f$在$\boldsymbol{x}_0$处可微，则$f$在$\boldsymbol{x}_0$处的任意方向$\boldsymbol{u} = (u_1,u_2,\cdots,u_n)$的方向导数都存在，且
$$
    \frac{\partial f}{\partial \boldsymbol{u}}(\boldsymbol{x}_0) = \frac{\partial f}{\partial x_1}(\boldsymbol{x}_0) u_1 +  \frac{\partial f}{\partial x_2}(\boldsymbol{x}_0) u_2 + \cdots + \frac{\partial f}{\partial x_n}(\boldsymbol{x}_0) u_n
$$

证：由于$f$在$\boldsymbol{x}_0$处可微，从而
$$
    f(\boldsymbol{x}_0 + t \boldsymbol{u}) - f(\boldsymbol{x}_0) = \sum_{i=1}^n \frac{\partial f}{\partial x_i} (\boldsymbol{x}_0) tu_i + o(t)
$$
而
$$
    \frac{\partial f}{\partial \boldsymbol{u}}(\boldsymbol{x}_0) = \lim \limits_{t \to 0} \frac{f(\boldsymbol{x}_0+t \boldsymbol{u}) - f(\boldsymbol{x})}{t} = \sum_{i=1}^n \frac{\partial f}{\partial x_i} u_i
$$

Q.E.D.
