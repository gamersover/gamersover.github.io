---
title: 函数积分四：Lebesgue定理
date: 2021-05-25 21:14:07
tags:
    - 数学分析
    - 函数积分
    - Riemann积分
    - 零测集
categories: 数学
mathjax: true
---

#### 定义1：零测度集
> 设$A$为实数的集合，如果对任意给定的$\varepsilon > 0$， 存在至多可数个开区间$\{I_n: n \in \mathbb{N}^*\}$组成$A$的一个开覆盖，并且$\displaystyle \sum_{n=1}^{\infty} |I_n| \le \varepsilon$($|I_n|$表示开区间$I_n$的长度)，那么称$A$是零测度集，简称零测集。

<!--more-->

#### 定理1
> 至多可数个零测集的并集是零测集。

证：设有可数个零测集
$$
    A_1,A_2,\cdots, A_n,\cdots
$$
对任意给定的$\varepsilon > 0$和$n \in N^*$，存在开区间族$\{I_{ni}: n,i \in \mathbb{N^+}\}$使得$\displaystyle A_n \subset \bigcup \limits_{i=1}^\infty I_{ni}$，且$\displaystyle \sum_{i=1}^\infty |I_{ni}| \le \frac{\varepsilon}{2^n}$，此时有
$$
    \bigcup \limits_{i=1}^\infty A_n \subset \bigcup \limits_{i=1}^\infty (\bigcup \limits_{i=1}^\infty I_{ni})
$$
而
$$
    \sum_{i=1}^\infty \sum_{i=1}^\infty |I_{ni}| \le \sum_{i=1}^\infty \frac{\varepsilon}{2^n} = \varepsilon
$$
这就证明了$\displaystyle \bigcup \limits_{i=1}^\infty A_i$是零测集。

Q.E.D.

#### 定理2
> 设$\omega$是有界函数$f$在$[a,b]$上的振幅，那么
$$
    \omega = \sup \{ |f(y_1) - f(y_2)|: y_1,y_2 \in [a,b] \}
$$

证：用$M$和$m$分别表示$f$在$[a,b]$上的上、下确界，那么由定义可知，$\omega = M - m$，又由于对于任意的$y_1,y_2 \in [a,b] $，有
$$
    m \le f(y_1) \le M, \quad m \le f(y_2) \le M
$$
从而
$$
    \omega = M - m \ge |f(y_1) - f(y_2)|
$$
另一方面，由于$M = \sup\{ f(y): y\in [a,b] \}$，$m = \inf\{ f(y): y \in [a,b] \}$，所以对任意的$\varepsilon > 0$，存在$y_1,y_2 \in [a,b]$，使得
$$
    f(y_1) \ge M - \frac{\varepsilon}{2}, \quad f(y_2) \le m + \frac{\varepsilon}{2}
$$
从而
$$
    |f(y_1) - f(y_2)| \ge f(y_1) - f(y_2) \ge M - m - \varepsilon = \omega - \varepsilon
$$
所以$\omega$是$\{ |f(y_1) - f(y_2)|: y_1,y_2 \in [a,b] \}$的上确界。

Q.E.D.

#### 定理3
> 设$\omega_f(x, r)$为$f$在$B_r(x)$区间的振幅，则$\lim \limits_{r \to 0^+} \omega_f(x, r)$极限存在，并记
$$
    \omega_f(x) = \lim \limits_{r \to 0^+} \omega_f(x, r)
$$
称$\omega_f(x)$为$f$在点$x$处的振幅。

证：由于$\omega_f(x, r) \ge 0$，有下界，且当$r$减少时，$f$在$B_r(x)$区间的上确界$M$递减，下确界$m$递增，所以$\omega_f(x, r)$递减，从而$\displaystyle \lim \limits_{r \to 0^+} \omega_f(x, r)$存在。

Q.E.D.

#### 定理4
> 函数$f$在$x \in I$处连续的充分必要条件是$\omega_f(x) = 0$。

证：必要性。设$f$在$x \in I$处连续，则对任意给定的$\varepsilon > 0$，当$r > 0$充分小时，存在$y \in B_r(x)$时，有
$$
    |f(y) - f(x)| < \frac{\varepsilon}{2}
$$
从而当$y_1,y_2 \in B_r(x)$时，有
$$
    |f(y_1) - f(y_2)| \le |f(y_1) - f(x)| + |f(x) - f(y_2)| < \varepsilon
$$
所以$\omega_f(x, r) \le \varepsilon$，令$r \to 0^+$，此时有$0 < \omega_f(x) \le \varepsilon$，由于$\varepsilon$是任取的，所以$\omega_f(x) = 0$。
充分性。设$\omega_f(x) = 0$，则对任意的$\varepsilon > 0$，存在$r > 0$，使得
$$
    \omega_f(x, r) < \varepsilon
$$
从而对任何的$y \in B_r(x)$，有
$$
    |f(x) - f(y)| \le \omega_f(x, r) < \varepsilon
$$
即表明$f$在点$x$处连续。

Q.E.D.

#### 定理5
> 对$\delta > 0$，记
$$
    D_\delta = \{ x \in [a, b]: \omega_f(x) \ge \delta\}
$$
记$D(f)$为$f$在$[a,b]$上不连续点的全体。则有
$$
    D(f) = \bigcup \limits_{n=1}^\infty D_{1/n}
$$

证：任取$x \in \bigcup \limits_{n=1}^\infty D_{1/n}$，知$\omega_f(x) > 0$，从而由[定理4](https://gamersover.github.io/2021/05/25/函数积分4/#定理4)可知$x$是$f$的不连续点，从而
$$
    \bigcup \limits_{n=1}^\infty D_{1/n} \subset D(f) \tag{1}
$$
反之，任取$x \in D(f)$，可知$\omega_f(x) > 0$，从而存在充分大的$m \in \mathbb{N^+}$，使得$\displaystyle \omega_f(x) \ge \frac{1}{m}$，从而有$x \in D_{1/m}$，所以
$$
    D(f) \subset \bigcup \limits_{i=1}^\infty D_{1/n} \tag{2}
$$
从而由(1)和(2)可知
$$
    D(f) = \bigcup \limits_{i=1}^\infty D_{1/n}
$$

Q.E.D.

#### 定理6
> 设$f:[a,b] \to \mathbb{R}$。如果存在一列区间$(\alpha_j, \beta_j)(j=1,2,\cdots,)$，使得$D(f) \subset \bigcup \limits_{i=1}^\infty (\alpha_j, \beta_j)$，记$K = [a,b] \backslash \bigcup \limits_{i=1}^\infty (\alpha_j, \beta_j)$，那么对任意的$\varepsilon > 0$，存在$\delta > 0$，当$x \in K, y \in [a,b]$，且$|x - y| < \delta$时，有$|f(x) - f(y)| < \varepsilon$。

证：反证法。如果结论不成立，则必存在$\varepsilon_0 > 0$以及$s_n \in K, t_n \in [a,b]$，使得当$|s_n - t_n| < 1 / n$时，有
$$
    |f(s_n) - f(t_n)| \ge \varepsilon_0
$$
由于$\{s_n\} \subset K \subset [a,b]$，存在必有$\{s_n\}$的子列$\{s_{k_n}\}$，使得
$$
    \lim \limits_{n \to \infty} s_{k_n} = s^*
$$
又由于$K$是闭集，从而$s^* \in K$。而
$$
    \begin{aligned}
    |t_{k_n} - s^*| &\le |t_{k_n} - s_{k_n}| + |s_{k_n} - s^*| \\
    & \le \frac{1}{k_n} + |s_{k_n} - s^*| \le \frac{1}{n} + |s_{k_n} - s^*|
    \end{aligned}
$$
令$n \to \infty$，得$t_{k_n} \to s^*$，由于$s^* \in K$，所以$f$在$s^*$处连续，且
$$
    |f(s_{k_n}) - f(t_{k_n})| \ge \varepsilon_0
$$
令上式左边$n \to \infty$，得
$$
    \varepsilon_0 \le |f(s^*) - f(s^*)| = 0
$$
显然与$\varepsilon_0 > 0$矛盾。

Q.E.D.

#### 定理7：Lebesgue
> 设函数$f$在有限区间$[a,b]$上有界，那么$f$在$[a.b]$上Riemann可积的充分必要条件是$D(f)$是一个零测集。

证：必要性。只需要证明对任意的$\delta > 0$，$D_{\delta}$是零测集，从而$D_1,D_{1/2},\cdots$都是零测集，再由[定理5](https://gamersover.github.io/2021/05/25/函数积分4/#定理5)可知$D(f)$是零测集。由于$f$可积，从而由[函数积分三的定理5](https://gamersover.github.io/2021/05/14/函数积分3/#定理5)可知对任意给定的$\varepsilon > 0$，存在$[a,b]$上的一个分割
$$
    \pi: a = x_0 < x_1 < \cdots < x_m = b
$$
使得
$$
    \sum_{i=1}^m \omega_i \Delta x_i < \frac{\delta \epsilon}{2}
$$
设$x \in D_{\delta}$，可知如果$x$不是$x_0,x_1,\cdots, x_m$中的任一个，则存在$i \in {1,2,\cdots,m}$，使得$x \in (x_{i-1}, x_i)$，因此存在充分小的$r>0$，使得$(x-r, x+r) \subset (x_{i-1}, x_i)$，于是$f$在$(x_{i-1}, x_i)$上的振幅
$$
    \omega_i \ge w_f(x, r) \ge w_f(x) \ge \delta
$$
如果用$\sum^\prime$和$\bigcup^\prime$分别表示对满足$D_{\delta} \cap (x_{i-1}, x_i) \ne \varnothing$的$i$的求和与求并，则
$$
    \frac{\delta \epsilon}{2} > \sum \limits_{i=1}^m \omega_i \Delta x_i \ge \sum \nolimits^\prime \omega_i \Delta x_i \ge \delta \sum \nolimits^\prime \Delta x_i
$$
所以
$$
    \sum \nolimits^\prime \Delta x_i \le \frac{\varepsilon}{2}
$$
而
$$
    D_\delta \subset (\bigcup \nolimits^\prime (x_{i-1}, x_i)) \bigcup \{ x_0, x_1, \cdots,x_m \}
$$
自然有
$$
    D_\delta \subset (\bigcup \nolimits^\prime (x_{i-1}, x_i)) \bigcup (\bigcup_{j=0}^m (x_j - \frac{\varepsilon}{4(m+1)}, x_j + \frac{\varepsilon}{4(m+1)}))
$$
而
$$
    \sum \nolimits^\prime \Delta x_i + (m+1) \frac{2\varepsilon}{4(m+1)} < \frac{\varepsilon}{2} + \frac{\varepsilon}{2} = \varepsilon
$$
所以$D_\delta$是零测集。

充分性。设$D(f)$是一个零测集，并且对任意给定的$\varepsilon > 0$，存在一列开区间$(\alpha_i, \beta_i)(i=1,2,\cdots)$，使得
$$
    D(f) \subset \bigcup \limits_{i=1}^\infty (\alpha_i, \beta_i), \quad 且 \quad \sum_{i=1}^\infty (\beta_i - \alpha_i) < \frac{\varepsilon}{2\omega}
$$
这里$\omega$是$f$在$[a,b]$上的振幅。令
$$
    K = [a, b] \backslash \bigcup \limits_{i=1}^\infty (\alpha_i, \beta_i)
$$
由[定理6](https://gamersover.github.io/2021/05/25/函数积分4/#定理6)可知，对上述的$\varepsilon > 0$，存在$\delta > 0$， 使得当$x \in K, y \in [a, b]$且$|x - y| < \delta$时，有
$$
    |f(x) - f(y)| < \frac{\varepsilon}{4(b - a)}
$$
现取分割
$$
    \pi : a = x_0 < x_1 < \cdots < x_n = b
$$
且$\Vert \pi \Vert < \delta$，记
$$
    \sum_{i=1}^\infty \omega_i \Delta x_i = \sum \nolimits_1 \omega_i \Delta x_i + \sum \nolimits_2 \omega_i \Delta x_i
$$
其中$\sum_1$表示对满足$K \cap (x_{i-1}, x_i) \ne \varnothing$的$i$的求和，$\sum_2$表示对满足$K \cap (x_{i-1}, x_i) = \varnothing$的$i$的求和。对$\sum_1$中的项，任取$y_i \in K \cap (x_{i-1}, x_i)$，由[定理6](https://gamersover.github.io/2021/05/25/函数积分4/#定理6)得
$$
    \begin{aligned}
    \omega_i &= sup\{ |f(z_1) - f(z_2)|: z_1, z_2 \in [x_{i-1}, x_i] \} & \\
    &\le sup\{ |f(z_1) - f(y_i)| + |f(z_2) - f(y_i)|: z_1,z_2 \in [x_{i-1}, x_i], y_i \in K \cap (x_{i-1}, x_i)\} \\
    & \le \frac{\varepsilon}{2(b-a)}
    \end{aligned}
$$
所以
$$
    \sum \nolimits_1 \omega_i \Delta x_i < \frac{\varepsilon}{2(b-a)} (b-a) = \frac{\varepsilon}{2}
$$
对于$\sum_2$中的项，当$x \in (x_{i-1}, x_i)$时，必有$x \notin K$，所以$\displaystyle x \in \bigcup_{i=1}^\infty (\alpha_i, \beta_i)$，即$\displaystyle (x_{i-1}, x_i) \subset \bigcup_{i=1}^\infty (\alpha_i, \beta_i)$，所以
$$
    \sum \nolimits_2 \omega_i \Delta x_i \le \omega \sum \nolimits_2 \Delta x_i < \omega \frac{\varepsilon}{2\omega} = \frac{\varepsilon}{2}
$$
所以
$$
    \sum_{i=1}^\infty \omega_i \Delta x_i < \varepsilon
$$

Q.E.D.