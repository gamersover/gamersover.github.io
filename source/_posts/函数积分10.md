---
title: 函数积分十：二重积分的计算
date: 2021-07-19 20:09:42
tags:
    - 数学分析
    - 函数积分
    - 二重积分
categories: 数学
mathjax: true
---

#### 定理1
> 如果$f$在$I = [a,b] \times [c,d]$上可积，那么单变量函数$\displaystyle \varphi(x) = \underline \int_c^d f(x, y) \mathrm{d} y$和$\displaystyle \psi(x) = \overline \int_c^d f(x, y) \mathrm{d} y$在区间$[a,b]$上可积，且
$$
    \int_I f \mathrm{d} \sigma = \int_a^b \varphi(x) \mathrm{d} x = \int_a^b \psi(x) \mathrm{d} x
$$

<!--more-->

证：分别对$[a,b]$和$[c,d]$的分割
$$
    \begin{aligned}
    \pi_x: a = x_0 < x_1 < \cdots < x_n = b, \\
    \pi_y: c = y_0 < y_1 < \cdots < y_m = d,
    \end{aligned}
$$
令
$$
    \begin{aligned}
        & I_i = [x_{i-1}, x_i] \quad (i=1,2,\cdots,n) \\
        & J_j = [y_{j-1}, y_j] \quad (j=1,2,\cdots,m)
    \end{aligned}
$$
则子矩形
$$
    I_i \times I_j \quad (i=1,2,\cdots,n; j=1,2,\cdots,m)
$$
形成了矩形$I$的分割$\pi = \pi_x \times \pi_y$。令$\displaystyle A = \int_I f \mathrm{d} \sigma$，由积分存在的定义可知，对任意的$\varepsilon > 0$，存在$\delta > 0$，当$I$的分割$\pi$满足$\Vert \pi \Vert < \delta$时，必有
$$
    A - \varepsilon < \sum_{i=1}^n \sum_{j=1}^m f(\xi_i, \eta_j) \Delta x_i \Delta y_j < A + \varepsilon
$$
其中$\xi_i \in I_i, \eta_j \in J_j (i=1,2,\cdots,n;j=1,2,\cdots,m)$，现取分割$\pi_x, \pi_y$满足$\Vert \pi_x \Vert < \delta / \sqrt 2, \Vert \pi_y \Vert < \delta / \sqrt 2$，那么$\Vert \pi \Vert < \delta$，从而上式成立，所以有
$$
    \begin{aligned}
    A - \varepsilon &\le \sum_{i=1}^n \sum_{j=1}^m \inf f(\xi_i, \eta_j) \Delta x_i \Delta y_j  \\
    & \le \sum_{i=1}^n \sum_{j=1}^m \sup f(\xi_i, \eta_j) \Delta x_i \Delta y_j \\
    & \le A + \varepsilon
    \end{aligned}
$$
而$\displaystyle \sum_{j=1}^m \inf f(\xi_i, \eta_j) \Delta y_j$表示函数$f(\xi_i)$在$[c,d]$上的下和，所以
$$
    \sum_{j=1}^m \inf f(\xi_i, \eta_j) \Delta y_j \le \underline \int_c^d f(\xi_i, y) \mathrm{d} y = \varphi(\xi_i)
$$
同理
$$
    \sum_{j=1}^m \sup f(\xi_i, \eta_j) \Delta y_j \le \overline \int_c^d f(\xi_i, y) \mathrm{d} y = \psi(\xi_i)
$$
从而
$$
    A - \varepsilon \le \sum_{i=1}^n \varphi(\xi_i) \Delta x_i \le \sum_{i=1}^n \psi(\xi_i) \Delta x_i \le A + \varepsilon
$$
即
$$
    \lim_{\Vert \pi_x \Vert \to 0} \sum_{i=1}^n \varphi(\xi_i) \Delta x_i = \lim_{\Vert \pi \Vert \to 0} \sum_{i=1}^n \psi(\xi_i) \Delta x_i = A
$$
成立

Q.E.D.

#### 定理2
> 设$f$在$I = [a,b] \times [c, d]$上可积，如果对每一个$x \in [a,b]$，函数$f(x, y)$在$[c, d]$上可积，则
$$
    \int_I f \mathrm{d} \sigma = \int_a^b \left(\int_c^d f(x, y) \mathrm{d} y \right) \mathrm{d} x
$$
上面等式右边称为累次积分，也可以记为
$$
\int_a^b \mathrm{d} x \int_c^d f(x, y) \mathrm{d} y
$$
同样，如果对于每一个$y \in [c, d]$，函数$f(x, y)$在$[a,b]$上可积，那么有
$$
    \int_I f \mathrm{d} \sigma = \int_c^d \left(\int_a^b f(x, y) \mathrm{d} x \right) \mathrm{d} y 
$$
上面等式右边也可以记为
$$
\int_c^d \mathrm{d} y \int_a^b f(x, y) \mathrm{d} x
$$

证：由[定理1](#定理1)可知，
$$
    \varphi(x) = \psi(x) = \int_c^d f(x, y) \mathrm{d} y
$$
所以
$$
    \int_I f \mathrm{d} \sigma = \int_a^b \varphi(x) \mathrm{d} x = \int_a^b \mathrm{d} x \int_c^d f(x, y) \mathrm{d} y
$$
后半部分同样的证明方法。

Q.E.D.


#### 定理3
> 设$f$是$[a,b] \times [c, d]$上的连续函数，则有
$$
    \int_c^d \mathrm{d} y \int_a^b f(x, y) \mathrm{d} x = \int_a^b \mathrm{d} x \int_c^d f(x, y) \mathrm{d} y
$$

证：由于$f$连续，从而$\varphi(x)$与$\psi(x)$都可积，再由[定理2](#定理2)易证。

Q.E.D.


#### 定理4
> 设点集
$$
    B = \{(x, y): y_1(x) \le y \le y_2(x), a \le x \le b\}
$$
其中函数$y_1,y_2$在$[a,b]$上连续，函数$f$在$B$上可积。如果对任意的$x \in [a,b]$，单变量积分
$$
    \int_{y_1(x)}^{y_2(x)} f(x, y) \mathrm{d} y
$$
存在，那么
$$
    \int_B f \mathrm{d} \sigma = \int_a^b \mathrm{d} x \int_{y_1(x)}^{y_2(x)} f(x, y) \mathrm{d} y
$$

证：令$c = \inf y_1([a, b]), d = \sup y_2([a, b])$，从而$I = [a, b] \times [c, d] \supset B$，由于$f$在$B$上可积，从而$f_B$在$I$上可积，而且
$$
    \int_B f \mathrm{d} \sigma = \int_I f_B \mathrm{d} \sigma
$$
显然易知，对每一个$x \in [a,b]$，$f_B(x, y)$在$[c, d]$上可积，所以由[定理2](#定理2)可知，
$$
    \int_I f_B \mathrm{d} \sigma = \int_a^b \mathrm{d} x \int_c^d f_B(x, y) \mathrm{d} y = \int_a^b \mathrm{d} x \int_{y_1(x)}^{y_2(x)} f_B \mathrm{d} y = \int_a^b \mathrm{d} x\int_{y_1(x)}^{y_2(x)} f(x, y) \mathrm{d} y
$$

Q.E.D.

#### 定义1：正则映射
> 设有界闭域$D \subset \mathbb{R}^2$，连续函数$F: D \to \mathbb{R}$，映射$\boldsymbol{\varphi}$由公式
$$
    x = x(u, v), \quad y = y(u, v) \quad ((u, v) \in \Delta)
$$
定义，其中$\Delta$是$uv$平面上的有界闭区域，设映射$\boldsymbol{\varphi}$是正则的，即$\boldsymbol{\varphi}$是从$\Delta$到$D$上的一对一的映射，$\boldsymbol{\varphi}$在$\Delta$上连续可导，并且
$$
    \frac{\partial (x, y) }{\partial (u, v)} = \begin{vmatrix} 
    \frac{\partial x}{\partial u} & \frac{\partial x}{\partial v} \\
    \frac{\partial y}{\partial u} & \frac{\partial y}{\partial v}
    \end{vmatrix} \neq 0
$$
在$\Delta$上成立。


#### 定理5
> 设正则映射$\boldsymbol{\varphi}$把$\mathbb{R}^2$中以
$$
    (u_0, v_0), \quad (u_0 + h, v_0), \quad (u_0+h, v_0 +h), \quad (u_0, v_0 +h)
$$
为顶点的的矩形$A_{hk}$一对一的映射为$\boldsymbol{\varphi}(A_{hk})$，那么
$$
    \lim \limits_{ h\to 0, k \to 0} \frac{\sigma(\boldsymbol{\varphi}(A_{hk}))}{\sigma(A_{hk})} =  \left| \frac{\partial(x, y)}{\partial(u, v)} \right|_{(u_0, v_0)}
$$

证：由映射后的图像有
$$
    \sigma(\boldsymbol{\varphi}(A_{hk})) \approx \Vert (\boldsymbol{\varphi}(u_0 + h, v_0) - \boldsymbol{\varphi}(u_0, v_0)) \times (\boldsymbol{\varphi}(u_0, v_0 + k) - \boldsymbol{\varphi}(u_0, v_0))  \Vert
$$
由于
$$
    \begin{aligned}
    \boldsymbol{\varphi}(u_0 + h, v_0) - \boldsymbol{\varphi}(u_0, v_0) = \frac{\partial \boldsymbol{\varphi}}{\partial u} (u_0, v_0) h + \boldsymbol{\xi} \\
    \boldsymbol{\varphi}(u_0, v_0+h) - \boldsymbol{\varphi}(u_0, v_0) = \frac{\partial \boldsymbol{\varphi}}{\partial v} (u_0, v_0) h + \boldsymbol{\eta}
    \end{aligned}
$$
其中
$$
    \Vert \boldsymbol{\xi} \Vert = o(h), \quad \Vert \boldsymbol{\eta} \Vert = o(k)
$$
所以
$$
    \sigma(\boldsymbol{\varphi}(A_{hk})) \approx \Vert \frac{\partial \boldsymbol{\varphi}}{\partial u}(u_0, v_0) \times \frac{\partial \boldsymbol{\varphi}}{\partial v}(u_0, v_0) \Vert hk + o(hk)
$$
而
$$
    hk = \sigma(A_{hk})
$$
所以上式可以写为
$$
    \frac{\sigma (\boldsymbol{\varphi}(A_{hk}))}{\sigma(A_{hk})} \approx \Vert \frac{\partial \boldsymbol{\varphi}}{\partial u}(u_0, v_0) \times \frac{\partial \boldsymbol{\varphi}}{\partial v}(u_0, v_0) \Vert + o(1)
$$
又因为
$$
    \frac{\partial \boldsymbol{\varphi}}{\partial u} \times \frac{\partial \boldsymbol{\varphi}}{\partial v} = \left|
    \begin{matrix}
    \boldsymbol{i} & \boldsymbol{j} & \boldsymbol{k}\\
    \frac{\partial x}{\partial u} & \frac{\partial x}{\partial v} & 0 \\
    \frac{\partial y}{\partial u} & \frac{\partial y}{\partial v} & 0 \\
    \end{matrix}
    \right| = \frac{\partial(x, y)}{\partial(u, v)} \boldsymbol{k}
$$
所以
$$
    \Vert \frac{\partial \boldsymbol{\varphi}}{\partial u} \times \frac{\partial \boldsymbol{\varphi}}{\partial v} \Vert = \left| \frac{\partial (x, y)}{\partial(u, v)} \right|
$$
从而
$$
 \frac{\sigma (\boldsymbol{\varphi}(A_{hk}))}{\sigma(A_{hk})} \approx \left| \frac{\partial(x, y)}{\partial(u, v)} \right|_{(u_0, v_0)} + o(hk)
$$
所以当$h \to 0, k \to 0$时，有
$$
    \frac{\sigma (\boldsymbol{\varphi}(A_{hk}))}{\sigma(A_{hk})} = \left| \frac{\partial(x, y)}{\partial(u, v)} \right|_{(u_0, v_0)}
$$

> 笔者注：感觉该证明方法不太好，约等于记号不应该用在这里，就算使用也应该讲明原因。

Q.E.D.


#### 定理6
> 设$\mathbb{R}^2$中的有界闭区域$D$有面积，函数$F: \to \mathbb{R}$，映射
$$
    \boldsymbol{\varphi}: \left\{ \begin{aligned}
    x = x(u, v) \\
    y = y(u, v)
    \end{aligned} \right.  \quad (u, v) \in \Delta
$$
是从$\Delta$到$D$上的正则映射，那么
$$
    \iint \limits_D F(x, y) \mathrm{d} x \mathrm{d} y = \iint \limits_\Delta F \circ \boldsymbol{\varphi}(u, v) \left| \frac{\partial(x, y)}{\partial(u, v)} \right| \mathrm{d} u \mathrm{d} v
$$

证：用矩形$I$把$uv$平面上的闭区域$\Delta$覆盖起来，用两族平行直线$u =u_i (i=0,1,2, \cdots, m)$和$v = v_j (j=0,1,2, \cdots,n)$分割$I$，其中
$$
    u_0 < u_1 < \cdots < u_{m-1} < u_m, \quad v_0 < v_1 < \cdots < v_{n-1} < v_n
$$
令$\Delta u_i = u_i - u_{i-1}(i=1,2,\cdots,m), \Delta v_j = v_j - v_{j-1}(j=1,2,\cdots,n)$。分割后可以得到$mn$个矩形，在映射$\boldsymbol{\varphi}$的作用下，它们变成了$xy$平面下的$mn$个曲边平行四边形，这时只需要考虑那些完全被包含在$D$中的曲边平行四边形，将它们记为$D_i(i=1,2,\cdots,k)$，即$D_i=\boldsymbol{\varphi}(\Delta_i)$，其中$\Delta_i(i=1,2,\cdots,k)$是完全被包含在$\Delta$中的矩形，任取一点$\boldsymbol{\eta}_i \in D_i$ ，并设$\Delta_i$中唯一的点$\xi_i$，使得$\boldsymbol{\varphi} (\xi_i) = \eta_i(i=1,2,\cdots,k)$，作积分和
$$
    \sum_{i=1}^k F(\boldsymbol{\eta}_i) \sigma(D_i)
$$
由[定理5](#定理5)可知
$$
    \sigma(D_i) \sim |det J \boldsymbol{\varphi}(\xi_i)| \sigma(\Delta_i) \quad (i=1,2,\cdots, k)
$$
所以得到
$$
    \sum_{i=1}^k F(\boldsymbol{\eta}_i) \sigma(D_i) \sim \sum_{i=1}^k F \circ \boldsymbol{\varphi} (\boldsymbol{\xi}_i) |det J \boldsymbol{\varphi} (\boldsymbol{\xi}_i)|  \sigma(\Delta_i)
$$
当分割无限细时，由[函数积分九的定理7](https://gamersover.github.io/2021/07/13/函数积分9#定理7)可得，
$$
    \int_D F \mathrm{d} \sigma = \int_\Delta F \circ \boldsymbol{\varphi} |J \boldsymbol{\varphi}| \mathrm{d} \sigma
$$

Q.E.D.

#### 定理7：极坐标换元
> 令$x = r \cos \theta, y= r \sin \theta$，则
$$
    \iint \limits_D F(x, y) \mathrm{d} x \mathrm{d} y = \iint \limits_\Delta F(r \cos \theta, r \sin \theta) r \mathrm{d} r \mathrm{d} \theta
$$

证：这时
$$
    \frac{\partial(x, y)}{\partial (u, v)} = \left| \begin{matrix}
    \cos \theta & -r\sin \theta \\
    \sin \theta & r \cos \theta
    \end{matrix}
    \right| = r
$$
代入[定理6](#定理6)的结果即证。

Q.E.D.